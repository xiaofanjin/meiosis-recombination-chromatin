# meiosis-recombination-chromatin
Scripts and notebooks used for analysis / visualization in Jin et al. 2021 
"Genome-wide variability in recombination activity is associated with meiotic chromatin organization".  
https://doi.org/10.1101/2021.01.06.425599

  
notebooks:  
hicPileups.ipynb: 2D averaged Hi-C matrix pileup plots around peaks  
heatmaps.ipynb: enrichment heatmap plots  
vennDiagrams.ipynb: enrichment heatmap plots  
boxbarplots.ipynb: box plots for recombination activity by chromhmm and bar plots for A/B compartment fractions  
tracePlots.ipynb: 1D averaged signal tracks around peaks  
tracePlotsChromHMMsplit.ipynb: 1D averaged signal tracks around peaks split by chromhmm annotation  
PsCurves.ipynb: P(s) curve analysis plots  
olspca.ipynb: PCA and least squares + feature selection analysis / plots  

scripts:  
fireCaller.R: R script to call fire scores using firecaller package  
splitMulticolBedgraph.sh: split bedgraphs generated by binBed.sh - use _maxScore.bg for ChIP-seq, _weightedScore.bg for crossovers  
getHiCtracks.py: generates log insulation score, cis/total ratio, traditional and fine grain eigenvector compartment scores from Hi-C datasets in cooler format  
binBed.sh: map bed (chromhmm tracks) and bedgraph (ChIP-seq, crossovers) files to 5kb bins  
makeMatrixFiles.py: writes cooler Hi-C data to disk, used to calling FIRE scores  
addGCTrackToCooler.py: adds a GC track to cooler for use with eigenvector decomposition  
getFireScores.sh: outer wrapper script to get FIRE scores, that calls makeMatrixFiles.py and fireCaller.R  
tab2bed.sh: convert .tab files of mapped crossovers from Yin et al. 2019 to bedgraph files, assigning each crossover a score that is 1/length  
splitChromHMMBed.sh: split chromHMM bed file with all 7 states combined to 7 separate bed files, 1 for each state  
